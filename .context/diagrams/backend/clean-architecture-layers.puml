@startuml Clean Architecture Layers
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

title JobWise Backend - Clean Architecture Layers

Container_Boundary(presentation, "Presentation Layer") {
    Component(routers, "FastAPI Routers", "HTTP Controllers", "Handle HTTP requests/responses, validation, serialization")
    Component(middleware, "Middleware", "Cross-cutting concerns", "Authentication, CORS, logging, rate limiting")
    Component(serializers, "Serializers", "Data transformation", "Request/response DTOs and validation")
}

Container_Boundary(application, "Application Layer") {
    Component(use_cases, "Use Cases", "Business workflows", "Orchestrate domain services for specific business operations")
    Component(app_services, "Application Services", "Service layer", "Profile, Job, Generation, Document services")
    Component(dto_models, "DTOs", "Data transfer objects", "Cross-boundary data contracts")
}

Container_Boundary(domain, "Domain Layer") {
    Component(entities, "Domain Entities", "Business models", "Profile, Job, Document, Generation entities")
    Component(value_objects, "Value Objects", "Immutable objects", "Email, Phone, Skills, Keywords")
    Component(domain_services, "Domain Services", "Business logic", "AI Orchestrator, Validation, Scoring")
    Component(repositories, "Repository Interfaces", "Data contracts", "Abstract repository definitions")
}

Container_Boundary(infrastructure, "Infrastructure Layer") {
    Component(db_repos, "Database Repositories", "Data persistence", "SQLAlchemy implementations")
    Component(external_apis, "External API Adapters", "Third-party integrations", "OpenAI, Job APIs, PDF services")
    Component(caching, "Caching Layer", "Performance optimization", "Redis, in-memory caching")
    Component(config, "Configuration", "Settings management", "Environment-based configuration")
}

' Dependency Rules (Clean Architecture)
routers --> use_cases : "depends on"
routers --> dto_models : "uses"
middleware --> app_services : "may use"

use_cases --> domain_services : "orchestrates"
use_cases --> entities : "works with"
app_services --> domain_services : "delegates to"
app_services --> repositories : "uses interface"

domain_services --> entities : "operates on"
domain_services --> value_objects : "uses"
entities --> value_objects : "contains"

db_repos ..|> repositories : "implements"
external_apis --> config : "configured by"
caching --> config : "configured by"

note top of domain
Domain Layer Rules:
- No dependencies on outer layers
- Contains core business logic
- Framework-agnostic
- Most stable layer
end note

note bottom of infrastructure
Infrastructure Layer:
- Depends on domain interfaces
- Implements repository contracts
- Handles external concerns
- Most volatile layer
end note

note left of presentation
Presentation Layer:
- Handles HTTP protocol
- Validates input/output
- Manages serialization
- User interface concerns
end note

note right of application
Application Layer:
- Orchestrates use cases
- Coordinates domain services
- Manages transactions
- Business workflow logic
end note

@enduml