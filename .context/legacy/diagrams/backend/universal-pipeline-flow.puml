@startuml Universal AI Orchestrator Flow
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

title JobWise Universal AI Pipeline - Current Implementation Status (F1-F6 Complete, F7-F8 Ready)

participant "Mobile App\n(Flutter)" as Mobile
participant "Generation API\n(F7 Structure)" as API
participant "Universal AI Orchestrator\n(F7 Ready)" as Orchestrator
participant "Service Factory\n(F7 Pattern)" as Factory
participant "Mock LLM Service\n(F7 Implementation)" as MockLLM
participant "Professional Templates\n(F7 Ready)" as Templates
participant "Text Exporter\n(F8 Structure)" as TextExport
participant "Cache Service\n(Structure Ready)" as Cache
participant "Database\n(F2 Complete)" as Database
participant "Monitoring\n(Structure Ready)" as Monitor

== Foundation Working (F1-F6 Complete) ==
note over Mobile, Monitor
    âœ… **F1-F6 Solid Foundation**
    - F1: FastAPI application with middleware, health checks, error handling
    - F2: SQLAlchemy async database with single schema, all tables created
    - F3: JWT authentication working (13/13 tests passing - 100% success)
    - F4: Profile management complete (CRUD, analytics, value objects)
    - F5: Job discovery working (static data, search, 6/6 tests passing)
    - F6: Custom job descriptions complete (CRUD, keyword extraction)
end note

== Mock AI Pipeline Initialization (F7 Structure Ready) ==
Mobile -> API: âœ… POST /api/v1/generations/resume\n(using real F4 profile + F5/F6 job data)
API -> Orchestrator: ðŸš§ execute_pipeline(profile, job)\n(Mock implementation prepared)
Orchestrator -> Factory: ðŸš§ create_mock_llm_service(MOCK_PROVIDER)\n(Service factory pattern ready)
Factory -> MockLLM: ðŸš§ initialize_mock_adapter(config)\n(Professional mock responses)
Factory --> Orchestrator: ðŸš§ MockLLMService instance

== Mock Stage Execution with Professional Results ==
loop for each of 5 pipeline stages
    Orchestrator -> Cache: ðŸš§ get(mock_prompt_cache_key)\n(Caching structure ready)
    Cache --> Orchestrator: ðŸš§ cache_miss (first generation)
    
    Orchestrator -> Monitor: ðŸš§ start_timer("stage_execution")\n(Performance tracking ready)
    
    == Mock Professional LLM Processing ==
    Orchestrator -> MockLLM: ðŸš§ generate_completion(mock_llm_request)\n(Template-based responses)
    
    alt Mock Stage 1: Job Analysis
        MockLLM -> Templates: ðŸš§ load_job_analysis_template()\n(Professional analysis patterns)
        Templates --> MockLLM: ðŸš§ ATS keywords, requirements, skills analysis
        MockLLM --> Orchestrator: ðŸš§ **Mock** JobAnalysisResult\n(Realistic keywords, skill requirements)
        note right: **Mock Timing**: 1.5s\n**Output**: ATS keywords, requirements\n**Quality**: Professional analysis
    
    else Mock Stage 2: Profile Compilation  
        MockLLM -> Templates: ðŸš§ load_profile_scoring_template()\n(Using real F4 profile data)
        Templates --> MockLLM: ðŸš§ Experience scoring, skill matching algorithms
        MockLLM --> Orchestrator: ðŸš§ **Mock** ProfileCompilationResult\n(Scored experiences 0.8-0.95)
        note right: **Mock Timing**: 1.2s\n**Output**: Ranked experiences, skill scores\n**Quality**: Professional relevance scoring
    
    else Mock Stage 3: Document Generation
        MockLLM -> Templates: ðŸš§ load_resume_template(modern/professional)\n(Multiple template options)
        Templates --> MockLLM: ðŸš§ Professional resume structure, content patterns
        MockLLM --> Orchestrator: ðŸš§ **Mock** DocumentGenerationResult\n(Professional resume content)
        note right: **Mock Timing**: 2.5s\n**Output**: Complete tailored resume\n**Quality**: ATS-optimized, professional formatting
    
    else Mock Stage 4: Quality Validation
        MockLLM -> Templates: ðŸš§ load_quality_validation_template()\n(ATS compliance patterns)
        Templates --> MockLLM: ðŸš§ Quality metrics, ATS compliance rules
        MockLLM --> Orchestrator: ðŸš§ **Mock** ValidationResult\n(ATS score 0.85-0.95)
        note right: **Mock Timing**: 1.0s\n**Output**: ATS score, keyword coverage\n**Quality**: Professional validation metrics
    
    else Mock Stage 5: Text Export (F8 Structure)
        Orchestrator -> TextExport: ðŸš§ generate_text_file(content)\n(F8 export framework ready)
        TextExport --> Orchestrator: ðŸš§ **Mock** TextExportResult\n(Clean .txt formatting)
        note right: **Mock Timing**: 0.5s\n**Output**: Professional .txt file\n**Quality**: Clean formatting, download ready
    end
    
    Orchestrator -> Cache: ðŸš§ set(stage_result, ttl=3600)\n(Performance optimization)
    Orchestrator -> Monitor: ðŸš§ record_stage_success("mock_stage", latency)\n(Monitoring ready)
end

== Mock Provider Health & Performance ==
Orchestrator -> Monitor: ðŸš§ get_mock_provider_performance()\n(Mock performance simulation)
Monitor --> Orchestrator: ðŸš§ mock_performance{speed: "ultra_fast", cost: "$0.001", quality: "professional"}

note over Orchestrator: **Mock Implementation Benefits**\n- Instant testing of full pipeline\n- Professional-quality output simulation\n- Realistic timing for UX development\n- Cost-free development and testing

== Database Integration (F2 Working) ==
Orchestrator -> Database: âœ… save_generation_record(generation_metadata)\n(F2 database working)
Database --> Orchestrator: âœ… Generation entity saved\n(Using real database operations)

Orchestrator -> Database: ðŸš§ save_document_record(mock_document)\n(F8 structure ready)
Database --> Orchestrator: ðŸš§ Document entity saved\n(DocumentModel defined)

== Response Assembly (F7-F8 Ready) ==
Orchestrator -> Orchestrator: ðŸš§ assemble_mock_pipeline_result()\n(Professional mock results)
Orchestrator --> API: ðŸš§ PipelineResult(document, metadata, mock_stats)\n(Realistic response structure)
API --> Mobile: ðŸš§ GenerationResponse(document_id, download_url, generation_stats)\n(Professional user experience)

== Background Monitoring (Structure Ready) ==
Monitor -> Monitor: ðŸš§ analyze_mock_performance()\n(Performance simulation)
Monitor -> Factory: ðŸš§ optimize_mock_responses(performance_data)\n(Continuous improvement simulation)

note over MockLLM, Templates
**F7 Mock Implementation Features**:
âœ… Professional resume templates (modern, classic, ATS-optimized)
âœ… Realistic processing timing (5s total pipeline)
âœ… High-quality mock responses with proper structure
âœ… ATS compliance simulation (85-95% scores)
âœ… Keyword coverage analysis simulation
âœ… Error scenario simulation for testing
âœ… Multiple template support (modern, professional, creative)
âœ… Progressive quality improvement simulation
end note

note over TextExport, Database
**F8 Export System Ready**:
ðŸš§ Text file generation (.txt format)
ðŸš§ Professional formatting templates
ðŸš§ Download endpoint structure prepared
ðŸš§ File storage and cleanup system ready
ðŸš§ PDF export framework (future enhancement)
ðŸš§ Document metadata tracking
ðŸš§ User-friendly filename generation
end note

note over API, Monitor
**Implementation Readiness**:
âœ… **F1-F6 Foundation**: Solid, tested, working
ðŸš§ **F7 Mock AI**: Structure complete, ready for implementation
ðŸš§ **F8 Export**: Framework ready, text export prepared
ðŸ“‹ **Next Steps**: 
   1. Implement F7 mock responses (2 days)
   2. Implement F8 text export (1 day)
   3. End-to-end testing and refinement
end note

@enduml