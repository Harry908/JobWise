@startuml JobWise-System-Architecture
!theme plain
title JobWise System Architecture

' Define components
package "Client Layer" {
  [Flutter Mobile App] as FlutterApp
  [Local Storage] as LocalStorage
  [PDF Viewer] as PDFViewer
}

package "API Gateway" {
  [FastAPI Backend] as Backend
  [REST API] as API
}

package "AI Processing" {
  [AI Orchestrator] as AIOrchestrator
  [Job Analyzer] as JobAnalyzer
  [Profile Compiler] as ProfileCompiler
  [Document Generator] as DocumentGenerator
  [Quality Validator] as QualityValidator
  [PDF Exporter] as PDFExporter
}

package "Data Layer" {
  database "Database\n(SQLite/PostgreSQL)" as DB
  [Cache\n(Memory/Redis)] as Cache
  [File Storage] as FileStorage
}

package "External Services" {
  cloud "LLM Provider\n(OpenAI)" as LLMProvider
  cloud "Job APIs\n(Indeed/LinkedIn)" as JobAPIs
}

' Define relationships
FlutterApp --> API : HTTP/REST
API --> Backend
Backend --> AIOrchestrator : Process Generation
Backend --> DB : CRUD Operations
Backend --> Cache : Store/Retrieve
Backend --> JobAPIs : Fetch Jobs

AIOrchestrator --> JobAnalyzer : Stage 1
JobAnalyzer --> ProfileCompiler : Stage 2
ProfileCompiler --> DocumentGenerator : Stage 3
DocumentGenerator --> QualityValidator : Stage 4
QualityValidator --> PDFExporter : Stage 5

JobAnalyzer --> LLMProvider : Analyze Job
ProfileCompiler --> LLLProvider : Score Relevance
DocumentGenerator --> LLMProvider : Generate Content
QualityValidator --> LLMProvider : Validate Quality

PDFExporter --> FileStorage : Store PDF
Backend --> FileStorage : Retrieve Files

FlutterApp --> LocalStorage : Cache Data
FlutterApp --> PDFViewer : Display PDF

' Add notes
note right of AIOrchestrator
  5-Stage Pipeline:
  1. Job Analysis (1500 tokens)
  2. Profile Compilation (2000 tokens)
  3. Document Generation (3000 tokens)
  4. Quality Validation (1500 tokens)
  5. PDF Export (local processing)
  
  Total Budget: 8000 tokens
end note

note right of DB
  Prototype: SQLite
  Production: PostgreSQL
  
  Stores:
  - User Profiles
  - Job Listings
  - Generated Documents
  - Generation History
end note

note right of FlutterApp
  State Management:
  - Prototype: Provider
  - Production: Riverpod
  
  Features:
  - Master Resume CRUD
  - Job Search & Browse
  - Generation Tracking
  - Offline Support
end note

@enduml